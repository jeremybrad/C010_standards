# META.yaml Specification

**Version**: 1.0
**Created**: 2025-11-21
**Maintainer**: C010_standards
**Ops/Logging**: C001_mission-control

---

## Purpose

META.yaml is a lightweight metadata contract in every project root that enables:
- Quick project context without reading entire READMEs
- Consistent folder/file documentation across all repos
- Service port registry
- Cross-project relationship mapping
- Drift detection and compliance checking

---

## Schema

```yaml
# Project metadata for [project_name]
# Auto-generated by Claude - agents should keep this current

project:
  last_reviewed: 2025-11-21      # REQUIRED: Date META.yaml was last verified accurate
  summary: "One-line description" # REQUIRED: What this project does (under 100 chars)
  status: active                  # REQUIRED: active | stale | experimental | archived
  series: P                       # REQUIRED: C | P | W
  port: 8820                      # OPTIONAL: Primary service port (if applicable)
  client: ClientName              # OPTIONAL: Client name (for W-series work projects)

folders:
  # REQUIRED: Document all top-level folders (except .git, node_modules, venv, __pycache__)
  00_admin: "Administrative files and snapshots"
  10_docs: "Documentation"
  20_receipts: "Change receipts and evidence"
  30_config: "Configuration files"
  40_src: "Source code"
  70_evidence: "Evidence and artifacts"
  90_archive: "Archived items"

files:
  # REQUIRED: Document key files only (not every file)
  Makefile: "Build automation and health checks"
  CLAUDE.md: "Claude Code guidance"
  README.md: "Project documentation"

services:                          # OPTIONAL: For service-oriented projects
  service_name:
    port: 8820
    description: "What this service does"

relates_to:                        # OPTIONAL: Document meaningful relationships
  - C001_mission-control: "Credential access"
  - P030_ai-services: "Service integration"

maintainer_notes:                  # OPTIONAL: Important operational notes
  - "Gotchas, tips, warnings"
```

---

## Required Fields

| Field | Required | Description |
|-------|----------|-------------|
| `project.last_reviewed` | Yes | Date of last verification (YYYY-MM-DD) |
| `project.summary` | Yes | One-line description under 100 chars |
| `project.status` | Yes | One of: active, stale, experimental, archived |
| `project.series` | Yes | One of: C, P, W |
| `project.port` | No | Primary service port if applicable |
| `project.client` | No | Client name for W-series projects |
| `folders` | Yes | All top-level folders with descriptions |
| `files` | Yes | Key files only (Makefile, README, main scripts) |
| `services` | No | Service definitions with ports |
| `relates_to` | No | Cross-project dependencies |
| `maintainer_notes` | No | Operational notes and gotchas |

---

## Agent Contract

### When Entering a Project
1. Read META.yaml first to understand structure
2. Use it to navigate - don't waste time exploring folders blindly

### When Modifying a Project
1. Update `folders:` if you add/remove directories
2. Update `files:` if you add/remove key files
3. Update `services:` if ports change
4. Update `relates_to:` if relationships change
5. **Always** update `last_reviewed:` to today's date

### When Creating New Projects
1. Create META.yaml with all required fields
2. Set `last_reviewed:` to creation date
3. Include all top-level folders
4. Document key files

### What NOT to Document
- Every file (just key files)
- Build artifacts, caches, node_modules, venv
- Files that change frequently (logs, temp files)
- Hidden folders like .git, .cache, __pycache__

---

## Standard Betty Protocol Folder Descriptions

For consistency, use these descriptions for Betty Protocol folders:

```yaml
folders:
  00_admin: "Administrative files and snapshots"
  10_docs: "Documentation and guides"
  20_receipts: "Change receipts and evidence"
  30_config: "Configuration files"
  40_src: "Source code"
  50_data: "Data files (or symlink to external storage)"
  60_tests: "Test files and fixtures"
  70_evidence: "Evidence and artifacts"
  80_reports: "Generated reports"
  90_archive: "Archived items"
```

---

## Drift Detection

A nightly script checks for META.yaml drift:

**Script**: `~/SyncedProjects/scripts/check_meta_yaml_drift.py`
**Schedule**: 2:30 AM daily
**Logs**: `~/SyncedProjects/C001_mission-control/logs/meta_drift.log`

### What It Checks
1. Missing META.yaml files in P/C/W repos
2. `last_reviewed` date older than 30 days
3. Folders that exist but aren't documented
4. Key files missing from documentation
5. Documented items that no longer exist

### Manual Check
```bash
python3 ~/SyncedProjects/scripts/check_meta_yaml_drift.py
```

---

## Examples

### Core Infrastructure (C-series)
```yaml
project:
  last_reviewed: 2025-11-21
  summary: "Encrypted credential vault with secret scanning and health dashboards"
  status: active
  series: C
  port: 8820

folders:
  00_admin: "Administrative files and snapshots"
  40_src: "Source code"
  vault: "Vault core implementation"

files:
  Makefile: "Build automation and health checks"
  houston.js: "Houston AI assistant"

services:
  vault_api:
    port: 8820
    description: "Credential storage API (localhost only)"

relates_to:
  - P181_terminal-insights: "Feed integration for timeline events"

maintainer_notes:
  - "Port 8820 is localhost-only for security"
```

### Work Project (W-series)
```yaml
project:
  last_reviewed: 2025-11-21
  summary: "Weekly CMO performance reports from BigQuery"
  status: active
  series: W
  client: Wowway

folders:
  40_src: "Source code and generators"
  80_reports: "Published reports"

files:
  Makefile: "Build automation"
  QUICKSTART.md: "Step-by-step workflow"

relates_to:
  - W005_BigQuery: "Data source"
```

### Project (P-series)
```yaml
project:
  last_reviewed: 2025-11-21
  summary: "Real-time Claude-to-Claude collaboration via Apple Notes"
  status: active
  series: P

folders:
  00_admin: "Administrative files"
  40_src: "Source code"
  feeds: "Timeline feed storage"

files:
  Makefile: "Build automation"
  timeline.js: "Main timeline processor"

relates_to:
  - C001_mission-control: "Ops integration"
```

---

## Compliance

A project is **META.yaml compliant** when:
1. META.yaml exists in project root
2. All required fields are present
3. All top-level folders are documented
4. Key files (Makefile, README.md, CLAUDE.md) are documented if they exist
5. `last_reviewed` is within 30 days

Non-compliant projects are flagged in the nightly drift report.

---

## Changelog

| Date | Version | Change |
|------|---------|--------|
| 2025-11-21 | 1.0 | Initial specification |
